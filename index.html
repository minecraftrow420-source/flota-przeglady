<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Flota â€“ przeglÄ…dy, OC, tachograf</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Firebase (wersja kompatybilna â€“ DZIAÅA na GitHub Pages) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <style>
    /* --- STYL BEZ ZMIAN --- */
    :root{font-family:system-ui,-apple-system,Segoe UI;background:#0f172a;color:#e5e7eb}
    body{margin:0;padding:1.5rem;display:flex;justify-content:center}
    .app{width:100%;max-width:1150px;background:#020617;border-radius:1.5rem;padding:1.75rem 1.5rem 2.5rem}
    .app-title{font-size:1.6rem;font-weight:700;display:flex;gap:.6rem;align-items:center}
    .logo{width:40px;height:40px;border-radius:50%;background:#22c55e;display:flex;align-items:center;justify-content:center}
    .grid{display:grid;grid-template-columns:1fr 1.6fr;gap:1.5rem}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .card{background:#020617;border-radius:1.2rem;padding:1.2rem;border:1px solid #334155}
    table{width:100%;border-collapse:collapse;font-size:.85rem}
    th,td{padding:.45rem;border-bottom:1px solid #1e293b}
    th{color:#94a3b8;text-transform:uppercase;font-size:.7rem}
    tr.overdue{background:#7f1d1d55}
    tr.soon{background:#a1620755}
    .btn{border-radius:999px;padding:.4rem .9rem;border:none;cursor:pointer}
    .btn-primary{background:#22c55e;color:#022c22;font-weight:600}
    .btn-danger{background:#ef444455;color:#fecaca;border:1px solid #ef4444}
    input,select,textarea{background:#020617;border:1px solid #475569;border-radius:.7rem;color:#e5e7eb;padding:.4rem}
  </style>
</head>
<body>

<div class="app">
  <div class="app-title"><span class="logo">ðŸš›</span>Flota â€“ wspÃ³lne terminy</div>

  <main class="grid" style="margin-top:1rem">

    <!-- FORM -->
    <section class="card">
      <h3>Dodaj termin</h3>
      <form id="form">
        <input id="vehicle" placeholder="Pojazd / rejestracja" required><br><br>
        <select id="type">
          <option>PrzeglÄ…d techniczny</option>
          <option>OC / ubezpieczenie</option>
          <option>Legalizacja tachografu</option>
        </select><br><br>
        <input id="date" type="date" required><br><br>
        <button class="btn btn-primary">Dodaj</button>
      </form>
    </section>

    <!-- TABLE -->
    <section class="card">
      <h3>Wszystkie terminy (wspÃ³lne)</h3>
      <table>
        <thead>
          <tr><th>Pojazd</th><th>Rodzaj</th><th>Data</th><th></th></tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </section>

  </main>
</div>

<script>
  // ðŸ”¥ TWÃ“J FIREBASE CONFIG
  const firebaseConfig = {
    apiKey: "AIzaSyCYtnjGKsWC2GOhlgLL6iQcFj5mVRJOzRw",
    authDomain: "flota-przeglady.firebaseapp.com",
    projectId: "flota-przeglady",
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const tbody = document.getElementById('tbody');

  // LIVE DATA
  db.collection('reminders').orderBy('date').onSnapshot(snap => {
    tbody.innerHTML='';
    snap.forEach(doc => {
      const r = doc.data();
      const tr = document.createElement('tr');
      const diff = Math.floor((new Date(r.date) - new Date())/86400000);
      if(diff<0) tr.className='overdue';
      else if(diff<=30) tr.className='soon';
      tr.innerHTML = `
        <td>${r.vehicle}</td>
        <td>${r.type}</td>
        <td>${r.date}</td>
        <td><button class="btn btn-danger" onclick="del('${doc.id}')">UsuÅ„</button></td>`;
      tbody.appendChild(tr);
    })
  });

  // ADD
  document.getElementById('form').addEventListener('submit',e=>{
    e.preventDefault();
    db.collection('reminders').add({
      vehicle: vehicle.value,
      type: type.value,
      date: date.value,
      created: new Date()
    });
    e.target.reset();
  })

  // DELETE
  function del(id){
    if(confirm('UsunÄ…Ä‡ termin?')) db.collection('reminders').doc(id).delete();
  }
</script>

</body>
</html>
