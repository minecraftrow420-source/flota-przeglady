<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<title>Flota â€“ przeglÄ…dy, OC, tachograf</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
:root{
  --bg:#020617;
  --card:#020617cc;
  --border:#1e293b;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --green:#22c55e;
  --yellow:#facc15;
  --red:#ef4444;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;
}

body{
  margin:0;
  background:radial-gradient(circle at top,#020617,#000);
  color:var(--text);
  padding:24px;
}

.app{
  max-width:1400px;
  margin:auto;
}

.header{
  font-size:26px;
  font-weight:700;
  margin-bottom:18px;
}

.grid{
  display:grid;
  grid-template-columns:420px 1fr;
  gap:24px;
}
@media(max-width:1100px){.grid{grid-template-columns:1fr}}

.card{
  background:linear-gradient(180deg,#020617ee,#020617cc);
  border:1px solid var(--border);
  border-radius:20px;
  padding:22px;
  box-shadow:0 20px 60px #000;
}

.card h3{
  margin:0 0 14px;
  font-size:18px;
}

label{font-size:13px;color:var(--muted)}

input,select,textarea{
  width:100%;
  background:#020617;
  border:1px solid var(--border);
  border-radius:14px;
  padding:10px 12px;
  color:var(--text);
  outline:none;
}

textarea{resize:vertical;min-height:80px}

.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}

.btn{
  border-radius:999px;
  padding:12px 18px;
  border:none;
  cursor:pointer;
  font-weight:600;
}

.btn-primary{
  background:linear-gradient(135deg,#22c55e,#16a34a);
  color:#022c22;
}

.badge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
}
.badge.ok{background:#16a34a33;color:#22c55e;border:1px solid #22c55e55}
.badge.soon{background:#facc1533;color:#facc15;border:1px solid #facc1555}
.badge.over{background:#ef444433;color:#ef4444;border:1px solid #ef444455}

.table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
.table th{
  text-align:left;
  font-size:12px;
  color:var(--muted);
  padding:10px;
}
.table td{
  padding:14px 10px;
  border-top:1px solid var(--border);
}

tr.overdue{background:#7f1d1d55}
tr.soon{background:#78350f55}

.delete{
  background:#ef444420;
  border:1px solid #ef444455;
  color:#fecaca;
  border-radius:999px;
  padding:6px 12px;
  cursor:pointer;
}
</style>
</head>
<body>

<div class="app">
  <div class="header">ðŸš› Flota â€“ przeglÄ…dy, OC, legalizacja tachografu</div>

  <div class="grid">

    <!-- FORM -->
    <div class="card">
      <h3>Dodaj nowy termin</h3>
      <form id="form">
        <label>Pojazd / nr rejestracyjny</label>
        <input id="vehicle" placeholder="Np. Scania R450 NDZ4701" required>
        <br><br>

        <div class="row">
          <div>
            <label>Typ pojazdu</label>
            <select id="vehicleType">
              <option>CiÄ™Å¼arÃ³wka</option>
              <option>Naczepa</option>
              <option>SamochÃ³d osobowy</option>
            </select>
          </div>
          <div>
            <label>Rodzaj terminu</label>
            <select id="type">
              <option>PrzeglÄ…d techniczny</option>
              <option>OC / ubezpieczenie</option>
              <option>Legalizacja tachografu</option>
            </select>
          </div>
        </div>
        <br>

        <label>Termin (data)</label>
        <input id="date" type="date" required>
        <br><br>

        <label>Notatki</label>
        <textarea id="notes" placeholder="ITD, warsztatâ€¦"></textarea>
        <br>

        <button class="btn btn-primary">âž• Dodaj termin</button>
      </form>
    </div>

    <!-- TABLE -->
    <div class="card">
      <h3>NadchodzÄ…ce terminy floty</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Pojazd</th><th>Typ</th><th>Rodzaj</th><th>Data</th><th>Status</th><th></th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>

  </div>
</div>

<script>
const firebaseConfig={
  apiKey:"AIzaSyCYtnjGKsWC2GOhlgLL6iQcFj5mVRJOzRw",
  authDomain:"flota-przeglady.firebaseapp.com",
  projectId:"flota-przeglady"
};

firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();
const tbody=document.getElementById('tbody');

function daysDiff(d){return Math.floor((new Date(d)-new Date())/86400000)}

// LIVE
 db.collection('reminders').orderBy('date').onSnapshot(s=>{
  tbody.innerHTML='';
  s.forEach(doc=>{
    const r=doc.data();
    const diff=daysDiff(r.date);
    let cls='ok',row='';
    if(diff<0){cls='over';row='overdue'}
    else if(diff<=30){cls='soon';row='soon'}

    tbody.innerHTML+=`
      <tr class="${row}">
        <td>${r.vehicle}</td>
        <td>${r.vehicleType}</td>
        <td>${r.type}</td>
        <td>${r.date}</td>
        <td><span class="badge ${cls}">${diff<0?'Po terminie':diff+' dni'}</span></td>
        <td><button class="delete" onclick="del('${doc.id}')">UsuÅ„</button></td>
      </tr>`;
  })
 });

// ADD
form.addEventListener('submit',e=>{
  e.preventDefault();
  db.collection('reminders').add({
    vehicle:vehicle.value,
    vehicleType:vehicleType.value,
    type:type.value,
    date:date.value,
    notes:notes.value
  });
  e.target.reset();
});

function del(id){if(confirm('UsunÄ…Ä‡?'))db.collection('reminders').doc(id).delete()}
</script>

</body>
</html>
